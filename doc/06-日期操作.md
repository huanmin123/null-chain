# 日期操作

本文档介绍日期格式化、偏移、比较、间隔计算等功能。

## 日期格式化

### dateFormat() - 日期格式化

```java
// 日期格式化
String formatted = Null.of(new Date())
    .dateFormat(DateFormatEnum.YYYY_MM_DD_HH_MM_SS)
    .orElse("");

// 常用格式枚举
DateFormatEnum.YYYY_MM_DD_HH_MM_SS  // yyyy-MM-dd HH:mm:ss
DateFormatEnum.YYYY_MM_DD           // yyyy-MM-dd
DateFormatEnum.YYYY_MM              // yyyy-MM
DateFormatEnum.HH_MM_SS             // HH:mm:ss
```

## 日期偏移

### dateOffset() - 日期偏移（指定偏移量）

```java
// 日期向前偏移7天
Date futureDate = Null.of(new Date())
    .dateOffset(DateOffsetEnum.ADD, 7, TimeEnum.DAY)
    .orElse(new Date());

// 日期向后偏移1个月
Date pastDate = Null.of(new Date())
    .dateOffset(DateOffsetEnum.SUB, 1, TimeEnum.MONTH)
    .orElse(new Date());
```

### dateOffset() - 日期偏移（默认偏移量为1）

```java
// 日期向前偏移1天
Date tomorrow = Null.of(new Date())
    .dateOffset(DateOffsetEnum.ADD, TimeEnum.DAY)
    .orElse(new Date());

// 日期向后偏移1小时
Date pastHour = Null.of(new Date())
    .dateOffset(DateOffsetEnum.SUB, TimeEnum.HOUR)
    .orElse(new Date());
```

### 偏移方向枚举

```java
DateOffsetEnum.ADD        // 时间加
DateOffsetEnum.SUB        // 时间减
DateOffsetEnum.START       // 时间单位的开始时间
DateOffsetEnum.END         // 时间单位的结束时间
DateOffsetEnum.START_ADD   // 从时间单位的开始时间加
DateOffsetEnum.START_SUB   // 从时间单位的开始时间减
DateOffsetEnum.END_ADD     // 从时间单位的结束时间加
DateOffsetEnum.END_SUB     // 从时间单位的结束时间减
```

### 时间单位枚举

```java
TimeEnum.MILLISECONDS  // 毫秒
TimeEnum.SECONDS       // 秒
TimeEnum.MINUTES       // 分钟
TimeEnum.HOURS         // 小时
TimeEnum.DAYS          // 天
TimeEnum.WEEKS         // 星期
TimeEnum.MONTHS        // 月
TimeEnum.YEARS         // 年
```

## 日期比较

### dateCompare() - 日期比较

```java
// 比较两个日期的大小关系
Integer result = Null.of(date1)
    .dateCompare(date2)
    .orElse(0);

// 返回值说明：
// 1：当前日期大于指定日期
// 0：当前日期等于指定日期
// -1：当前日期小于指定日期

if (result > 0) {
    System.out.println("当前日期大于比较日期");
} else if (result < 0) {
    System.out.println("当前日期小于比较日期");
} else {
    System.out.println("两个日期相等");
}
```

**注意**：如果需要比较到日期后的时间，请保证单位一致性。比如都是 `yyyy-MM-dd HH:mm:ss`，不能有一个是 `yyyy-MM-dd` 另一个是 `yyyy-MM-dd HH:mm:ss`，这样会导致因为单位不一致，比较的结果不准确。

## 日期间隔

### dateBetween() - 日期间隔

```java
// 计算两个日期之间的间隔（天数）
Long days = Null.of(date1)
    .dateBetween(date2, TimeEnum.DAY)
    .orElse(0L);

// 计算两个日期之间的间隔（小时数）
Long hours = Null.of(date1)
    .dateBetween(date2, TimeEnum.HOUR)
    .orElse(0L);
```

**重要说明**：

1. **不包括开始时间，包括结束时间**
2. **日的计算**：比如 21~25 之间相差 4 天，如果需要算开始时间那么需要 +1
3. **周期计算**：比如 01~25 之间经过了多少周那么就是 3，因为第四周没有走完还差 2 天
4. **所以在有些时候需要完整的周期忽略未走完的需要 +1**

**注意时间单位的精确度**（建议对比的时候时间格式是一致的避免导致对比结果出问题）：

- **传入含时间的对象**（LocalDateTime/ZonedDateTime）：
  - 会精确对比年、月、日、时、分、秒、毫秒等所有维度
  - 计算的是 "完整单位间隔"—— 比如要凑够 24 小时才算 1 天，凑够 60 分钟才算 1 小时

- **传入仅日期的对象**（LocalDate）：
  - 只对比年、月、日，忽略时间
  - 只要日期跨 1 天，天数差就为 1（比如 12-01 到 12-02，不管时间是几点，天数差都是 1）

- **传入仅时间的对象**（LocalTime）：
  - 只对比时、分、秒、毫秒，无法对比日期相关单位（如天、周、月）

## 完整示例

```java
import com.gitee.huanminabc.nullchain.Null;
import com.gitee.huanminabc.nullchain.enums.DateFormatEnum;
import com.gitee.huanminabc.nullchain.enums.DateOffsetEnum;
import com.gitee.huanminabc.nullchain.enums.TimeEnum;
import java.util.Date;

public class DateExample {
    
    public void dateFormatExample() {
        Date now = new Date();
        
        // 格式化为 yyyy-MM-dd HH:mm:ss
        String formatted = Null.of(now)
            .dateFormat(DateFormatEnum.YYYY_MM_DD_HH_MM_SS)
            .orElse("");
        
        // 格式化为 yyyy-MM-dd
        String dateOnly = Null.of(now)
            .dateFormat(DateFormatEnum.YYYY_MM_DD)
            .orElse("");
    }
    
    public void dateOffsetExample() {
        Date now = new Date();
        
        // 明天
        Date tomorrow = Null.of(now)
            .dateOffset(DateOffsetEnum.ADD, 1, TimeEnum.DAY)
            .orElse(now);
        
        // 一周后
        Date nextWeek = Null.of(now)
            .dateOffset(DateOffsetEnum.ADD, 1, TimeEnum.WEEK)
            .orElse(now);
        
        // 一个月前
        Date lastMonth = Null.of(now)
            .dateOffset(DateOffsetEnum.SUB, 1, TimeEnum.MONTH)
            .orElse(now);
        
        // 获取今天的开始时间（00:00:00）
        Date startOfDay = Null.of(now)
            .dateOffset(DateOffsetEnum.START, TimeEnum.DAY)
            .orElse(now);
        
        // 获取今天的结束时间（23:59:59）
        Date endOfDay = Null.of(now)
            .dateOffset(DateOffsetEnum.END, TimeEnum.DAY)
            .orElse(now);
    }
    
    public void dateCompareExample() {
        Date date1 = new Date();
        Date date2 = new Date(System.currentTimeMillis() + 86400000); // 明天
        
        Integer result = Null.of(date1)
            .dateCompare(date2)
            .orElse(0);
        
        if (result < 0) {
            System.out.println("date1 小于 date2");
        }
    }
    
    public void dateBetweenExample() {
        Date date1 = new Date();
        Date date2 = new Date(System.currentTimeMillis() + 86400000 * 7); // 7天后
        
        // 计算间隔天数
        Long days = Null.of(date1)
            .dateBetween(date2, TimeEnum.DAY)
            .orElse(0L);
        
        // 计算间隔小时数
        Long hours = Null.of(date1)
            .dateBetween(date2, TimeEnum.HOUR)
            .orElse(0L);
    }
}
```

## 支持的日期类型

- `java.util.Date`
- `java.time.LocalDate`
- `java.time.LocalDateTime`
- `java.time.ZonedDateTime`
- `java.time.LocalTime`
- 时间戳（Long）

## 注意事项

1. **日期格式一致性**：比较日期时，建议使用相同的时间格式，避免精度不一致导致的问题
2. **时区问题**：使用 `ZonedDateTime` 时要注意时区设置
3. **月份和年份**：月份和年份的计算会考虑实际天数（如2月有28/29天）
4. **间隔计算**：间隔计算不包括开始时间，包括结束时间

